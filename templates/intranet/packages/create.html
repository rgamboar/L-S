{% extends 'intranet/base.html' %}
{% load staticfiles %}
{% block extra_head %}
    <link href="{% static 'css/print80.css' %}" rel="stylesheet">
{% endblock %}
{% block content %}

<div class="container">
        <div class="jumbotron">
        <div class="row">
        <h3 class="text-center"> Crear Guia de Flete</h3>
                {% if success %}
                    <div class="alert alert-success">
                        <strong>Se ha creado con exito!</strong> Puedes ver la <a href="{% url 'packageProfile' package.id %}" class="alert-link">Guia de Flete</a> o 
                        <a href="javascript:window.print()" class="alert-link" role="button">Imprimir</a>.
                    </div>
                {% endif %}
                {% if customerCheck %}
                    <div class="alert alert-danger">
                      <strong>No ingreso a un proveedor o consignatario correctamente!</strong>
                    </div>
                {% endif %}
        {% if form %}
            <div class="col-sm-1">
            </div>
            <form action="{% url 'package'%}" method="post">
            <div class="col-sm-5 default-form">
                    {% csrf_token %}
                    {% for field in form %}
                        <div class="form-group" {% if forloop.counter == 5 %}id="selectProvider"{% endif %}{% if forloop.counter == 6 %}id="selectConsignee"{% endif %}>
                            {{ field.label_tag }} {{ field }}
                            {% for err in field.errors %}
                                <span class="error_message">{{ err }}</span>
                            {% endfor %}
                        </div>
                        {% if forloop.counter == 5 %}
                            <div class="form-group">
                                <label for="checkProvider">Agregar Proveedor:</label>
                                <input name="checkbox" type="checkbox" id="checkProvider" />
                            </div>
                        {% endif %}
                        {% if forloop.counter == 6 %}
                            <div class="form-group">
                                <label for="checkboxConsignee">Agregar Consignatario:</label>
                                <input name="checkbox" type="checkbox" id="checkboxConsignee" />
                            </div>
                        {% endif %}

                    {% endfor %}
                <input type="submit" value="Crear" />
            </div>
            <div class="col-sm-5 default-form">
                <div class="panel-group">
                  <div id="provider" class="panel panel-default hidden">
                    <div class="panel-heading">Nuevo Proovedor</div>
                    <div class="panel-body">
                        <div class="col-sm-12">
                            {% if rutProvider %}
                                <div class="alert alert-danger">
                                  <strong>Rut ya existe en el sistema!</strong>
                                </div>
                            {% endif %}
                        {% for field in provider %}
                                <div class="form-group">
                                    {{ field.label_tag }} {{ field }}
                                    {% for err in field.errors %}
                                        <span class="error_message">{{ err }}</span>
                                    {% endfor %}
                                </div>
                        {% endfor %}
                        </div>
                    </div>
                  </div>
                  <div id="consignee" class="panel panel-default hidden">
                    <div class="panel-heading">Nuevo Consignatario</div>
                    <div class="panel-body">
                        <div class="col-sm-12">
                            {% if rutConsignee %}
                                <div class="alert alert-danger">
                                  <strong>Rut ya existe en el sistema!</strong>
                                </div>
                            {% endif %}
                        {% for field in consignee %}
                                <div class="form-group">
                                    {{ field.label_tag }} {{ field }}
                                    {% for err in field.errors %}
                                        <span class="error_message">{{ err }}</span>
                                    {% endfor %}
                                </div>
                        {% endfor %}
                        </div>
                    </div>
                  </div>
                </div>

                
                

            </div>
            </form>
            <div class="col-sm-1">
            </div>  
            

        {% endif %}
        </div>
    </div>
</div>


<div id="print" class="row">
<div class="title col-sm-12">
L&amp;S
</div>


<div class="line col-xs-12">
    <div class="col-xs-4">
        Guia de flete:
    </div>
    <div class="col-xs-8">
        {{package.id}}
    </div>
</div>

<div class="line col-xs-12">
    <div class="col-xs-4">
        Cliente:
    </div>
    <div class="col-xs-8">
        {{package.customer.name}} 
    </div>
</div>

{% if package.payer %}
<div class="line col-xs-12">
    <div class="col-xs-4">
        Consig.:
    </div>
    <div class="col-xs-8">
        {{package.consignee.name}} 
    </div>
</div>

{% else %}
<div class="line col-xs-12">
    <div class="col-xs-4">
        Proveedor:
    </div>
    <div class="col-xs-8">
        {{package.provider.name}} 
    </div>
</div>
{% endif %}

<div class="line col-xs-12">
    <div class="col-xs-4">
        Origen:
    </div>
    <div class="col-xs-8">
        {{package.start.name}}
    </div>
</div>

<div class="line col-xs-12">
    <div class="col-xs-4">
        Destino:
    </div>
    <div class="col-xs-8">
        {{package.finish.name}}
    </div>
</div>

<div class="line col-xs-12">
    <div class="col-xs-4">
        Volumen:
    </div>
    <div class="col-xs-8">
        {{package.volume}}
    </div>
</div>

<div class="line col-xs-12">
    <div class="col-xs-4">
        Cantidad:
    </div>
    <div class="col-xs-8">
        {{package.quantity}}
    </div>
</div>

<div class="line col-xs-12">
    <div class="col-xs-4">
        Peso:
    </div>
    <div class="col-xs-8">
        {{package.weight}}
    </div>
</div>

<div class="line col-xs-12">
    <div class="col-xs-4">
        Riesgo:
    </div>
    <div class="col-xs-8">
        {{package.risk}}
    </div>
</div>

<div class="line col-xs-12">
    <div class="col-xs-4">
        Recibido:
    </div>
    <div class="col-xs-8">
        {{package.createDate}}
    </div>
</div>

<div class="price col-xs-12">
    <div class="col-xs-4">
        Unitario:
    </div>
    <div class="col-xs-8">
        {% if package.rate == 0 %}
              No definido
        {% else %}
            {{package.rate}}    
        {% endif %}
    </div>
</div>

<div class="line col-xs-12">
    <div class="col-xs-4">
        Total:
    </div>
    <div class="col-xs-8 bold">
        {% if package.rate == 0 %}
              No definido
        {% else %}
            {{package.total}}    
        {% endif %}
    </div>
</div>

{% if package.finishAddress %}

<div class="price col-xs-12">
    <div class="col-xs-12">
        Direccion de entrega:
    </div>
    <div class="col-xs-12 address">
        {{package.finishAddress}}
    </div>
</div>

{% endif %}

<div class="jump col-xs-12">
</div>
<div class="line col-xs-12">
    <div class="sign col-xs-5">
        Encargado
    </div>
    <div class="col-xs-2">
    </div>
    <div class="sign col-xs-5">
        Cliente
    </div>
</div>



</div>


<script type="text/javascript">
    
$(function() {
  $(checkProvider).click(function() {
    $('#id_f-provider').val(null).trigger('change');
    $("#provider").toggleClass('hidden');
    $("#selectProvider").toggleClass('hidden');
    
  });
  $(checkboxConsignee).click(function() {
    $('#id_f-consignee').val(null).trigger('change');    
    $("#consignee").toggleClass('hidden');
    $("#selectConsignee").toggleClass('hidden');
  });
});


$( document ).ready(function() {
    {% if makeProvider %}
    $('#checkProvider')[0].checked = true;
    $("#provider").toggleClass('hidden');
    $("#selectProvider").toggleClass('hidden');
    {% endif %}
    {% if makeConsignee %}
    $('#checkboxConsignee')[0].checked = true;
    $("#consignee").toggleClass('hidden');
    $("#selectConsignee").toggleClass('hidden');
    {% endif %}
});

</script>
{% endblock %}